
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../google-signin/google-signin.html">
<link rel="import" href="../google-signin/google-signin-aware.html">

<dom-module id="my-mensaje-registro">
    <!--<link rel="stylesheet" type="text/css" href="my-item-ficha.css">-->
    <style is="custom-style">
        
    </style>
    
    <template>
       

               <paper-dialog id="dialog" modal>
                  <h1>Registro</h1>
                  <h2>Debe registrarse para poder jugar</h2>
                  <paper-input id="pedirFichaNombre" label="Nombre Usuario" ></paper-input>
    <google-signin brand="google" width="iconOnly" client-id="802865579551-t14nk2g98ohr8mqabcm8bbfmgcphushm.apps.googleusercontent.com"></google-signin>
    <google-signin-aware
        scopes="{{scope}}"
        signed-in="{{signedIn}}"
        offline="{{offline}}"
        is-authorized="{{isAuthorized}}"
        need-additional-auth="{{needAdditionalAuth}}"
        on-google-signin-aware-success="handleSignIn"
        on-google-signin-offline-success="handleOffline"
        on-google-signin-aware-signed-out="handleSignOut"></google-signin-aware>
    <p>User name:<span>{{userName}}</span></p>
                    <div class="buttons">
                        <paper-button id="pedirFicha" dialog-confirm>Accept</paper-button>
                    </div>
                </paper-dialog>
        
    </template>    
          
          
</dom-module>

<script>
var aware = document.querySelector('#awareness');
    aware.status = 'Not granted';
    aware.offlineCode = 'No offline login.';
    aware.userName = 'N/A';
    aware.handleSignIn = function(response) {
      this.status = 'Signin granted';
      // console.log('[Aware] Signin Response', response);
      this.userName = gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile().getName();
    };
    aware.handleOffline = function(response) {
      this.offlineCode = response.detail.code;
    };
    aware.handleSignOut = function(response) {
      this.status = 'Signed out';
      // console.log('[Aware] Signout Response', response);
      this.userName = 'N/A';
    };
    aware.disconnect = function() {
      var b = document.querySelector('google-signin');
      var currentUser = gapi.auth2.getAuthInstance().currentUser.get();
      if (currentUser) {
        currentUser.disconnect();
      }
      gapi.auth2.getAuthInstance().signOut();
    };

    Polymer({
        is: 'my-mensaje-registro',
        listeners: {
            'pedirFicha.tap': 'pedirFichaClick',
        },
        pedirFichaClick: function(e){
        var pedirFichaNombre = this.$$('#pedirFichaNombre');
         obtenerFicha(pedirFichaNombre.value);   
        },
        ready: function(){
        },
        abrir_mensaje: function(titulo,mensaje){
            var dialog = this.$$('#dialog');
            if (dialog) {
                dialog.open();
            }
        }
        
    });
</script>